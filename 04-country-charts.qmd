---
execute:
  cache: false
---

# Country Charts {#sec-04-country-charts}


```{r}
#| label: setup
#| results: hold
#| include: false

base::source(file = paste0(here::here(), "/R/helper.R"))

ggplot2::theme_set(ggplot2::theme_bw())


```

::::: {#obj-chapter-template}
:::: {.my-objectives}
::: {.my-objectives-header}
Objective of this chapter
:::

::: {.my-objectives-container}

I will display the yearly variations of the `r glossary("cantril ladder")` values for certain group of countries. Additionally I will compute and integrate the mean for the ladder scores of each group.

:::
::::
:::::

::: {.callout-important #imp-ls-functions}
To facilitate computing and plotting I have developed two functions:

- `my_get_ls_data`: creates the ladder score data for a country/region/group
- `my_ls-region`: display the ladder score line graph for a country/region/group

Both functions are called from the "R/helper.r" file, where you can also find the name and type of the necessary parameters. Typically I have used the following code chunk:

```
my_ls_region(
  df = my_get_ls_data(
    region_name = rlang::quo(`region5`), # specific column name for a regional group
    world_bank_group = "World [WLD]",    # specific world bank group to select all countries of the workd, removing duplicates from other world bank grouping classifications
    filter_string = "." # = no filter, "Europe" filters all values that contain "Europe, "^Europe$" filters all values with the exact name of "Europe".
  ), 
  fig_title = "Ladder Score for continents 2011-2024",
  mean_column = TRUE # standard, calculate the mean values for all regions
  legend_title = "Continent" # standard value = "Region"
)
```


:::


## Continents

In the following chapter I will present the ladder score for the five continents (Africa, Americas, Asia, Europe and Oceania). To see which country belongs to which continent have a look at @tbl-show-region5.

:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-04-ls-continents}
: Ladder Score by Continents
::::::
:::
::::{.my-r-code-container}


```{r}
#| label: ls-continent

my_ls_region(
  df = my_get_ls_data(
    group_name  = rlang::quo(`region5`),
    region_name = rlang::quo(`region5`),
    world_bank_group = "World [WLD]",
    filter_string = "."
  ), 
  fig_title = "Ladder score for continents (2011-2024)",
  legend_title = "Continent"
)

```

::::
:::::


### Africa

:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-04-african-region}
: Ladder Score by African regions
::::::
:::
::::{.my-r-code-container}
```{r}
#| label: ls-africa

my_ls_region(
  my_get_ls_data(
    group_name  = rlang::quo(`region23`),
    region_name = rlang::quo(`region23`),
    world_bank_group = "World [WLD]",
    filter_string = "Africa"
  ), 
  fig_title = "Ladder score for African regions (2011-2024)"
)
```
You can see the negative impact of the corona crisis especially in Middle and Western Africa. To see which country belongs to which continent have a look at @tbl-show-region23.
::::
:::::

### Europe

:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-04-ls-europe}
: Ladder Score for European regions (2011-2024)
::::::
:::
::::{.my-r-code-container}
```{r}
#| label: ls-europe

my_ls_region(
  my_get_ls_data(
    group_name  = rlang::quo(`region23`),
    region_name = rlang::quo(`region23`),
    world_bank_group = "World [WLD]",
    filter_string = "Europe"
  ), 
  fig_title = "Ladder score for European regions (2011-2024)"
)

```

::::
:::::




### Western Europe


:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-04-ls-western-europe}
: Evolution of life evaluation for Countries in Western Europe (2011-2024)
::::::
:::
::::{.my-r-code-container}
```{r}
#| label: ls-western-europe

my_ls_region(
  my_get_ls_data(
    group_name  = rlang::quo(`region23`),
    region_name = rlang::quo(`country_whr`),
    world_bank_group = "World [WLD]",
    filter_string = "Western Europe"
  ), 
  fig_title    = "Ladder score for countries in Western Europe (2011-2024)",
  legend_title = "Country"
)

```
***

For Western Europe countries Monaco and Lichtenstein are no data available.
::::
:::::



### Rankings

:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-04-west-europe-ranks}
: Rank changes for Countries in Western Europe 2011-2024
::::::
:::
::::{.my-r-code-container}
```{r}
#| label: show-rankings-west-europe

base::readRDS("data/whr-cantril/rds/whr_final.rds") |>
      dplyr::filter(
        region23 == "Western Europe"
          ) |> 
        base::droplevels() |> 
  plotly::plot_ly(
    x = ~ year,
    y = ~ rank,
    color = ~ country_whr,
    type = "scatter",
    mode = "lines+markers"
  ) |> 
  plotly::layout(
    title = "Changes in the Rank for West European Countries (2011-2024)",
    legend = base::list(title = list(text = 'Country')),
    xaxis = base::list(title = "Year"), 
    yaxis = base::list(title = "Rank", autorange = "reversed")
    )
```

::::
:::::

## DACH countries

As I am especially interested in my native country the next graph will compare the three German speaking countries DACH = Germany (**D**eutschland), **A**ustria and Switzerland (Country iso2 code = **CH**))

### Ladder scores

:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-show-eval-DACH}
: Evolution of life evaluation for German speaking countries
::::::
:::
::::{.my-r-code-container}
```{r}
#| label: show-life-eval-DACH

base::readRDS("data/whr-cantril/rds/whr_final.rds") |> 
    dplyr::filter(
        country_whr == "Austria" |
        country_whr == "Germany" |
        country_whr == "Switzerland"
        ) |> 
    dplyr::filter(group48 == "World [WLD]") |> 
    base::droplevels() |> 

    plotly::plot_ly(
      x = ~ year,
      y = ~ ladder_score,
      color = ~ country_whr,
      type = "scatter",
      mode = "lines+markers"
    ) |> 
    plotly::layout(
      title = "Changes in the Ladder Scores for DACH Countries (2011-2024)",
      legend = base::list(title = list(text = 'Country')),
      xaxis = base::list(title = "Year"), 
      yaxis = base::list(title = "Cantril Ladder Score")
      )

```

::::
:::::

### Rankings

:::::{.my-r-code}
:::{.my-r-code-header}
:::::: {#cnj-show-eval-DACH}
: Evolution of life evaluation for German speaking countries
::::::
:::
::::{.my-r-code-container}
```{r}
#| label: show-rankings-DACH

base::readRDS("data/whr-cantril/rds/whr_final.rds") |> 
    dplyr::filter(
        country_whr == "Austria" |
        country_whr == "Germany" |
        country_whr == "Switzerland"
        ) |> 
    dplyr::filter(group48 == "World [WLD]") |> 
    base::droplevels() |> 

    plotly::plot_ly(
      x = ~ year,
      y = ~ rank,
      color = ~ country_whr,
      type = "scatter",
      mode = "lines+markers"
    ) |> 
    plotly::layout(
      title = "Ranking Changes of Live Evaluations for DACH Countries (2011-2024)",
      legend = base::list(title = list(text = 'Country')),
      xaxis = base::list(title = "Year"), 
      yaxis = base::list(title = "Rank", autorange = "reversed")
      )

```

::::
:::::

## Glossary

```{r}
#| label: glossary-table
#| echo: false

glossary_table()
```

------------------------------------------------------------------------

## Session Info

::::: my-r-code
::: my-r-code-header
Session Info
:::

::: my-r-code-container
```{r}
#| label: session-info

sessioninfo::session_info()
```
:::
:::::


